R Programming 101
========================================================
author: 曾意儒 Yi-Ju Tseng
autosize: true
font-family: 'Microsoft JhengHei'


對應書本章節
========================================================
[1 R語言101](http://yijutseng.github.io/DataScienceRBook/intro.html)

RStudio Interface
========================================================
left: 30%
共有四個區塊，分別為：

- 程式碼編輯區 Source editor
- 執行視窗 Console
- 環境/物件
- 檔案/圖表/說明文件

***

![plot of chunk unnamed-chunk-1](figures/RStudio.png)

RStudio 使用步驟
========================================================
- New Project (如果原本沒有的話)
- New R Script (如果原本沒有的話)
- 在左上方**程式碼編輯區 Source editor**撰寫程式碼
- 將需要執行的程式碼反白，點選**Run**，執行程式碼
- 將游標移至需要執行的程式碼，點選**Run** 也可執行該行程式碼
- 程式碼會在左下方Console視窗執行，顯示結果
- 如果有畫圖，會出現在右下方視窗
- 可在右上方視窗檢查所有變數

Console視窗
========================================================
- 可直譯的語言
- 可在執行視窗(Console)直接打程式碼
- `>` : 輸入指令
- `+` : 表示前面的程式碼還沒打完
    - 鍵入完整的程式碼
    - **Esc**跳出

R = Base + Other Packages
========================================================
- 安裝套件Package的方法如下：

```r
install.packages("套件名稱")
```

- 套件名稱需要加上雙引號

```r
install.packages("ggplot2")
```

- 載入**已安裝**的套件：

```r
library(ggplot2)
```

- **不用**在套件名稱前後加雙引號


Functions - Basic
========================================================
- 內建Functions函數
- 安裝Packages套件後各套件也會提供多種函數
- 使用方式: `函數名稱(參數1,參數2,....)`

以計算平均數為例，可使用`mean()`函數:

```r
mean(c(1,2,3,4,5,6)) ##計算1~6的平均數
```

```
[1] 3.5
```

Functions - Arguments
========================================================
- 有些函數需要輸入參數
- `?函數名稱` 查詢所需參數與說明

```r
?mean
```

Functions - Arguments 順序
========================================================
- 函數的參數設定有順序性
- 不想照順序-->指定參數名稱

如序列產生函數`seq()`，參數順序為`from, to, by`，代表序列起點、序列終點，以及相隔單位。

```r
seq(from=1,to=9,by=2)#1~9，每隔2產生一數字
```

```
[1] 1 3 5 7 9
```

Functions - Arguments 順序
========================================================

```r
seq(from=1,to=9,by=2)#1~9，每隔2產生一數字
```

```
[1] 1 3 5 7 9
```

```r
seq(1,9,2)#按照順序輸入參數，可省去參數名稱
```

```
[1] 1 3 5 7 9
```

```r
seq(by=2,to=9,from=1)#不照順序輸入，需要參數名稱
```

```
[1] 1 3 5 7 9
```

Variable [<-]
========================================================
- 使用 `<-` 設定變數
- **變數名稱** `<-` **變數內容(值)**
- **變數名稱**可依箭頭方向放置於左側 `<-` 或右側 `->` 
- 但為方便閱讀，**變數名稱**多放置於左側


```r
a<-1 
a
```

```
[1] 1
```

```r
2->b
b
```

```
[1] 2
```

Variable [=]
========================================================
- 也可用 `=` 設定變數
- **變數名稱**必須在左側
- **變數名稱** `=` **變數內容**


```r
c=1 
c
```

```
[1] 1
```

Variable 命名規則
========================================================
- 不可使用保留字
    - break, else, FALSE, for, function, if, Inf, NA, NaN, next, repeat, return, TRUE, while等
- 開頭只能是英文字，或 `.`
- 大小寫敏感

str()
========================================================
用在檢查與總覽各類變數型態。


```r
d<-3
str(d)
```

```
 num 3
```

程式改錯
====================================
type:alert
- `3=a`
- `library("package_name")`
- `105CGUIM<-"Text"`
- `install.packages(package_name)`


資料型態
========================================================
- **數值 (numeric)**
- **字串 (character)**
- **布林變數 (logic)**
- **日期 (Date)**

數值 (numeric)
========================================================
數值包括
- 整數（沒有小數點）
- 浮點數（有小數點）


```r
num1<-100 
num2<-1000.001
```

若數值長度超過 2^53....
========================================================

```r
print(2^53, digits=20) 
```

```
[1] 9007199254740992
```

```r
print(2^53+1, digits=20) # +1後，數值仍與2^53相同
```

```
[1] 9007199254740992
```

數值 (numeric) - >2^53
========================================================
- 若數值長度超過 `2^53`，必須導入`bit64` package
- 上限提高為`2^63`

```r
library(bit64) # 導入bit64 package
print(as.integer64(2)^53, digits=20)
```

```
integer64
[1] 9007199254740992
```

```r
print(as.integer64(2)^53+1, digits=20)# 導入bit64後，可得正確答案
```

```
integer64
[1] 9007199254740993
```

字串 (character)
========================================================
- 用雙引號`"`框起 : 字串格式
- 數字前後加上雙引號 : 字串格式
    - 無法進行數值的加減乘除

```r
char1<-"abcTest" 
char2<-"100"
char3<-"200"
#char2+char3 
#會輸出Error message: non-numeric argument to binary operator
```


布林變數 (logic)
========================================================
- 用於邏輯判斷
- 大寫**TRUE**或**T**代表**真**
- 大寫**FALSE**或**F**代表假。

```r
boolT<-TRUE
boolT1<-T
boolF<-FALSE
boolF1<-F
```

日期 (Date)
========================================================
- 表示日期
- `Sys.Date()`可得系統日期


```r
dateBook<-Sys.Date()
dateBook
```

```
[1] "2018-02-26"
```

日期 (Date) - lubridate
========================================================
- `lubridate` package : 日期與字串的相關轉換操作
- `ymd()`函數 : 將`年/月/日`格式的文字轉換為日期物件
    - y表年year
    - m表月month
    - d表日day

```r
library(lubridate)
ymd('2012/3/3')
```

```
[1] "2012-03-03"
```


日期 (Date) - lubridate
========================================================
- `mdy()`函數 : 將`月/日/年`格式的文字轉換為日期物件
    - y表年year
    - m表月month
    - d表日day
- 以此類推


```r
mdy('3/3/2012')
```

```
[1] "2012-03-03"
```

- 其他使用方法：[The Yhat Blog](http://blog.yhat.com/static/pdf/R_date_cheat_sheet.pdf)

基本運算子: 數學運算
========================================================
數學運算與其他程式語言相同

- 加 `+`
- 減 `-`

```r
num1<-1
num2<-100
num1+num2
```

```
[1] 101
```

```r
num1-num2
```

```
[1] -99
```
***
- 乘 `*`
- 除 `/`
- 餘數 `%%`
- 次方 `^`

```r
num1*num2
```

```
[1] 100
```

```r
num1/num2
```

```
[1] 0.01
```

基本運算子: 進階數學運算
========================================================
- 四捨五入 `round()`

```r
num1<-1.568
num2<-2.121
round(num1,digits = 2) #四捨五入至小數點第二位
```

```
[1] 1.57
```

```r
round(num2,digits = 1) #四捨五入至小數點第一位
```

```
[1] 2.1
```
***
- 無條件捨去 `floor()`
- 無條件進位 `ceiling()`

```r
floor(num1) ##1.568
```

```
[1] 1
```

```r
ceiling(num2) ##2.121
```

```
[1] 3
```


基本運算子: 邏輯運算
========================================================
常用之邏輯判斷也可在R中直接使用
- 大於 `>`
- 小於 `<`

```r
num1<-1
num2<-100
num1>num2
```

```
[1] FALSE
```

```r
num1<num2
```

```
[1] TRUE
```

***

- 等於 `==`，**雙等號**
- 大於等於 `>=`
- 小於等於 `<=`

```r
num1==num2
```

```
[1] FALSE
```

```r
1==1
```

```
[1] TRUE
```

基本運算子: 邏輯運算
========================================================
文字字串也可比較大小

```r
char1<-"abcTest" 
char2<-"defTest"
char1>char2
```

```
[1] FALSE
```

基本運算子: 邏輯判斷
========================================================
在R中使用**單符號**即可表示且`&`和或`|`
- 且 `&`


```r
TRUE & TRUE
```

```
[1] TRUE
```

```r
TRUE & FALSE
```

```
[1] FALSE
```

***
在R中使用**單符號**即可表示且`&`和或`|`
- 或 `|`

```r
TRUE | TRUE
```

```
[1] TRUE
```

```r
TRUE | FALSE
```

```
[1] TRUE
```
基本運算子: 反向布林變數 !
========================================================


```r
!TRUE
```

```
[1] FALSE
```

```r
!FALSE
```

```
[1] TRUE
```

程式輸出結果？
====================================
type:alert
- `Sys.Date()`
- `20+"60"`
- `30>10 & 20>60`
- `!1000>50`

解讀錯誤訊息
========================================================

- Message：有可能的錯誤通知，程式會繼續執行
- Warning：有錯誤，但是不會影響太多，程式會繼續執行
- Error：有錯，而且無法繼續執行程式
- Condition：可能會發生的情況

```r
log(-1)
```

```
[1] NaN
```

```r
mena(NA)
```

```
Error in eval(expr, envir, enclos): 沒有這個函數 "mena"
```

解讀錯誤訊息 範例
========================================================
```
# Error: could not find function "fetch_NBAPlayerStatistics"
# 找不到"fetch_NBAPlayerStatistics" function
```
可能原因：沒安裝或沒讀入SportsAnalytics package


```
# Error in library(knitr): there is no package called 'knitr'
# 找不到"knitr" package
```
可能原因：沒安裝knitr package

Help
========================================================
- R語言與套件均有完整的文件與範例可以參考
- 輸入`?函數名稱`或`?套件名稱`

```r
?ggplot2
?ymd
```

- Google
- [Stack Overflow](http://stackoverflow.com/)也有許多問答


問問題
========================================================
如果找不到解答，發問時請附上：

- 可以重現錯誤的**程式碼**與**資料**
- 系統/套件的版本資訊

版本資訊可以透過執行下列程式碼取得：

```r
sessionInfo()
```


